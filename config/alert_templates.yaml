# Alert Template Configuration
# Purpose: Jinja2 templates for Telegram alerts
# Modified by: Admin
# Read by: alerts.alert_formatter

telegram:
  # Bot configuration
  bot_token: "${TELEGRAM_BOT_TOKEN}"
  chat_id: "${TELEGRAM_CHAT_ID}"
  parse_mode: "Markdown"
  disable_web_page_preview: true

  # Rate limiting for alerts
  max_alerts_per_hour: 20
  max_alerts_per_day: 100
  cooldown_seconds: 30  # Min time between alerts

templates:
  buy_signal: |
    {% if confidence >= 90 %}ğŸŸ¢{% elif confidence >= 70 %}ğŸŸ¡{% else %}ğŸ”µ{% endif %} *{{ signal_type }} SIGNAL* â€” `{{ symbol }}`{% if company_name %} _({{ company_name }})_{% endif %}

    ğŸ“Š *Strategy:* {{ strategy_name }}
    ğŸ¯ *Confidence:* `{{ confidence }}%` ({{ indicators_met }}/{{ total_indicators }})

    {{ indicators_summary }}

    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    ğŸ“ *TRADE SETUP*
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    â–«ï¸ Entry:      `{{ currency }}{{ entry_price }}`
    ğŸ”´ Stop Loss:  `{{ currency }}{{ stop_loss }}` (-{{ stop_loss_pct }}%)
    ğŸŸ¢ Target:     `{{ currency }}{{ target_price }}` (+{{ target_pct }}%)

    âš–ï¸ R:R = `1:{{ rr_ratio }}` | Risk `{{ currency }}{{ risk_amount }}` â†’ Reward `{{ currency }}{{ reward_amount }}`
    {% if has_trading_time %}
    ğŸ• *TIMING*
    ğŸ“… Entry: {{ entry_date }} | `{{ entry_window }}`
    â³ Valid: {{ signal_validity_days }} day(s) â†’ {{ validity_expiry }}
    ğŸ“Œ Hold: {{ holding_period }}
    {% endif %}
    {% if strategy_count > 1 %}ğŸ”— _Strategies: {{ contributing_strategies | join(', ') }}_
    {% endif %}
    _{{ timestamp }}_

  sell_signal: |
    *SELL SIGNAL - {{ strategy_name }}*

    Stock: {{ symbol }} ({{ company_name }})
    Exit Price: {{ currency }}{{ exit_price }}

    Entry: {{ currency }}{{ entry_price }}
    P&L: {{ pnl_pct }}% ({{ currency }}{{ pnl_amount }})

    Reason: {{ exit_reason }}

    _{{ timestamp }}_

  daily_summary: |
    ğŸ“‹ *DAILY SUMMARY*
    _{{ date }}_

    ğŸ” Scanned: `{{ stocks_scanned }}` stocks
    ğŸ“¡ Signals: `{{ signals_count }}` | Alerts: `{{ alerts_sent }}`{% if paper_trades_placed is defined and paper_trades_placed > 0 %}
    ğŸ“ Paper Trades: `{{ paper_trades_placed }}`{% endif %}

    ğŸ’¼ Positions: `{{ active_positions }}` | P&L: `{{ total_pnl_pct }}%`

    ğŸ† *Top Signals:*{% for signal in top_signals %}
    `{{ loop.index }}.` {{ signal.symbol }} â€” `{{ signal.confidence }}%`{% endfor %}

    â±ï¸ _Scan: {{ scan_duration }}s_

  error_alert: |
    *SYSTEM ERROR*

    Component: {{ component }}
    Error: {{ error_message }}
    Severity: {{ severity }}

    Action Required: {{ action_required }}

    _{{ timestamp }}_

  portfolio_update: |
    *PORTFOLIO UPDATE*

    Total Value: {{ currency }}{{ total_value }}
    Cash: {{ currency }}{{ cash_available }}
    Invested: {{ currency }}{{ invested_amount }}

    Today's P&L: {{ daily_pnl_pct }}%
    Total Return: {{ total_return_pct }}%
    Sharpe Ratio: {{ sharpe_ratio }}
    Max Drawdown: {{ max_drawdown_pct }}%

    Positions:
    {% for pos in positions %}
    {{ pos.symbol }}: {{ pos.pnl_pct }}% ({{ pos.quantity }} shares)
    {% endfor %}

    _{{ timestamp }}_

  paper_trade_summary: |
    ğŸ“ *PAPER TRADES PLACED*

    ğŸ’° Portfolio: `{{ currency }}{{ portfolio_value }}`
    ğŸ’µ Cash: `{{ currency }}{{ cash_balance }}`
    ğŸ“Š Positions: `{{ open_positions }}` | Return: `{{ total_return_pct }}%`

    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    *TRADES ({{ session_trades }})*
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”{% for trade in trades %}
    `{{ loop.index }}.` *{{ trade.symbol }}* â€” {{ trade.side }} Ã— {{ trade.quantity }}
        Entry `{{ currency }}{{ trade.entry_price }}` | SL `{{ currency }}{{ trade.stop_loss }}` | TP `{{ currency }}{{ trade.target_price }}`
    {% endfor %}

priority_styles:
  HIGH:
    prefix: "!!"
    suffix: ""
  MEDIUM:
    prefix: ""
    suffix: ""
  LOW:
    prefix: ""
    suffix: ""
